import { getIn, joinPath } from '../paths';
import { formatPath } from 'takeshape-routing';
import { generateWarning } from '../stats';
export default function createRouteFilter(config, stats) {
  return function (obj, routeName) {
    const route = getIn(config.routes, routeName);
    let path;

    if (route && route.path) {
      const pathResult = formatPath(route.path, obj);
      path = joinPath(config.pathPrefix, pathResult.path);

      if (pathResult.warnings.length) {
        const currentPath = this.lookup('currentPath');
        pathResult.warnings.forEach(variable => {
          generateWarning(stats, 'route-filter', `${currentPath} - failed to create '${routeName}' page - :${variable} resolves to undefined`);
        });
      }
    } else {
      path = '#';
    }

    return path;
  };
}
import ExtendableError from 'es6-error';
import { formatLocation } from './formatting';

function ensureArray(obj) {
  return Array.isArray(obj) ? obj : [obj];
}

function formatError(error) {
  const locations = error.locations ? error.locations.map(formatLocation).join(' ') : '';
  return `${locations} ${error.message}`;
}

function addErrorDetail(message, errors) {
  const detail = errors ? ensureArray(errors).map(formatError).join('\n') : '';
  return `${message}:\n${detail}`;
}

export default class GraphQLError extends ExtendableError {
  constructor(message, errors) {
    super(addErrorDetail(message, errors));
    this.errors = errors;
    this.originalMessage = message;
  }

}